@inject IConfiguration Configuration
@{
    ViewData["Title"] = "Attendance Register";
    Layout = "~/Areas/AdminPanel/Views/Shared/_AdminLayout.cshtml";
    string baseUrl = Configuration["BaseUrlSettings:baseUrl"];
    var uri = new Uri(baseUrl);
    string baseDomainUrl = $"{uri.Scheme}://{uri.Host}:{uri.Port}";

}


    <meta charset="UTF-8">
    <title>Attendance Register</title>

    <!-- DevExtreme -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/devextreme@23.2.3/dist/css/dx.light.css">
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.7.0/dist/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/devextreme@23.2.3/dist/js/dx.all.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/exceljs/4.3.0/exceljs.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>

<style>
    body {
        font-family: 'Segoe UI', sans-serif;
        margin: 0;
        padding: 0;
    }

    .header {
        background-color: #3f4d6b;
        color: white;
        font-size: 18px;
        font-weight: bold;
        padding: 12px 20px;
        display: flex;
        align-items: center;
        gap: 15px;
    }

    .back-btn:hover {
        background-color: #dfe6f1;
    }

    .main {
        display: flex;
        height: calc(100vh - 50px);
    }

    .left-section, .right-section {
        width: 50%;
        padding: 30px;
        background-color: #fff;
        box-sizing: border-box;
    }

    .separator {
        width: 1px;
        background-color: #ccc;
    }

    .date-row {
        display: flex;
        gap: 20px;
        align-items: center;
        flex-wrap: wrap;
    }

    .form-group {
        flex: 1;
    }

    label {
        font-weight: 600;
        display: block;
        margin-bottom: 4px;
        font-size: 13px;
        color: #333;
    }

    select,
    input[type="date"] {
        padding: 4px 6px;
        font-size: 13px;
        height: 32px;
        border-radius: 4px;
        border: 1px solid #ccc;
        width: 130px;
        box-sizing: border-box;
    }

    #branchDropdown {
        width: 180px;
    }

    .btn-group {
        margin-top: 20px;
        display: flex;
        gap: 10px;
    }

        .btn-group button,
        .header + .main button {
            padding: 6px 14px;
            font-size: 13px;
            min-width: 70px;
        }

    button {
        border: none;
        background-color: #3f4d6b;
        color: white;
        font-weight: bold;
        border-radius: 4px;
        cursor: pointer;
    }

    #recordCount {
        color: red;
        font-weight: 600;
        margin-bottom: 15px;
        display: none; /* Hidden by default */
    }

    #employeeAttendanceGrid {
        height: calc(100vh - 180px);
    }

    #monthSelect,
    #yearSelect {
        padding: 4px 6px;
        font-size: 13px;
        height: 30px;
        width: 110px;
        border-radius: 4px;
        border: 1px solid #ccc;
        box-sizing: border-box;
    }

    .back-btn {
        float: right;
        margin-top: 20px;
        margin-right: 40px;
    }

    /* Branch dropdown row styling */
    .branch-row {
        margin-bottom: 15px;
    }

    .filter-section {
        background-color: #f8f9fa;
        padding: 15px;
        border-radius: 5px;
        margin-bottom: 15px;
    }

    /* New styles for search and view section */
    .search-view-container {
        display: none; /* Hidden by default */
        margin-bottom: 15px;
        align-items: center;
        gap: 15px;
    }

        .search-view-container.show {
            display: flex; /* Show when data is loaded */
        }

        .search-view-container input {
            padding: 6px 10px;
            font-size: 13px;
            border: 1px solid #ccc;
            border-radius: 4px;
            width: 240px;
        }

        .search-view-container button {
            padding: 6px 14px;
            font-size: 13px;
            min-width: 70px;
        }

    /* No data message styling */
    .no-data-message {
        text-align: center;
        padding: 40px;
        color: #6c757d;
        font-style: italic;
        font-size: 14px;
    }

    /* Show record count when data is available */
    #recordCount.show {
        display: block;
    }

    .fixed-label {
        min-width: 100px;
        white-space: nowrap;
        margin-bottom: 0;
        text-align: right;
    }

    #attendanceModalBody table th,
    #attendanceModalBody table td {
        font-weight: normal;
        font-size: 13px;
    }

    #attendanceModalBody table thead th {
        font-weight: bold;
        position: sticky;
        top: 0;
        z-index: 10;
        background-color: #f8f9fa !important;
        box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }

    .custom-modal-width {
        max-width: 98% !important;
    }

    .attendance-table-container {
        max-height: 60vh;
        overflow: auto;
        position: relative;
    }

        /* Ensure sticky header works properly */
        .attendance-table-container table {
            position: relative;
        }

        /* Fix for scrollbar appearing under header */
        .attendance-table-container::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        .attendance-table-container::-webkit-scrollbar-track {
            background: #f1f1f1;
        }

        .attendance-table-container::-webkit-scrollbar-thumb {
            background: #888;
            border-radius: 4px;
        }

            .attendance-table-container::-webkit-scrollbar-thumb:hover {
                background: #555;
            }
</style>

    <div class="header">
        ATTENDANCE REGISTER
    </div>

    <div class="main">
        <!-- Left Section -->
        <div class="left-section">
            <div class="filter-section">
                <!-- Single Row for All Filters -->
                <div class="date-row">
                    <div class="form-group" style="width: 200px; display: inline-block; margin-right: 20px;">
                        <label for="branchDropdown">Branch:</label>
                        <div id="branchDropdown"></div>
                    </div>
                    <div class="form-group" style="width: 180px; display: inline-block; margin-right: 20px;">
                        <label for="monthSelect">Month:</label>
                        <select id="monthSelect" class="form-control">
                            <option value="1">January</option>
                            <option value="2">February</option>
                            <option value="3">March</option>
                            <option value="4">April</option>
                            <option value="5">May</option>
                            <option value="6">June</option>
                            <option value="7">July</option>
                            <option value="8">August</option>
                            <option value="9">September</option>
                            <option value="10">October</option>
                            <option value="11">November</option>
                            <option value="12">December</option>
                        </select>
                    </div>
                    <div class="form-group" style="width: 120px; display: inline-block;">
                        <label for="yearSelect">Year:</label>
                        <select id="yearSelect" class="form-control"></select>
                    </div>
                </div>
            </div>

            <div class="btn-group">
                <button onclick="onFind()" id="btnfind">Find</button>
                <button onclick="onClear()">Clear</button>
                <button onclick="goBack()">Back</button>
            </div>
        </div>

        <!-- Vertical Separator -->
        <div class="separator"></div>

        <!-- Right Section -->
        <div class="right-section">
            <!-- Record count - hidden by default -->
            <div id="recordCount">0 Records found.</div>

            <!-- Search and view container - hidden by default -->
            <div class="search-view-container" id="searchViewContainer">
                <input type="text" id="employeeSearch" placeholder="Search employees..." />
                <button id="btnView">View</button>
            </div>

            <!-- Grid container with no data message -->
            <div class="grid-wrapper" style="position: relative;" id="gridTag">
                <div id="grid-loader" class="grid-loader justify-content-center align-items-center flex-column"
                     style="display: none; inset: 0; background: rgba(255,255,255,0.6); z-index: 10;">
                    <img src="@baseDomainUrl/loders/loder.png" class="grid-logo-spinner" style="width: 30px; height: 30px; animation: spin 1s linear infinite;" />
                    <div class="grid-loading-text text-dark" style="font-size: 16px;">Loading...</div>
                </div>

                <!-- No data message - shown by default -->
                <div class="no-data-message" id="noDataMessage">
                    No data to display. Please select a branch and click Find to load employee data.
                </div>

                <!-- DevExtreme Grid -->
                <div id="employeeAttendanceGrid"></div>
            </div>
        </div>
    </div>

<!-- Modal -->
<!-- Modal -->
<div class="modal fade" id="attendanceModal" tabindex="-1" aria-labelledby="attendanceModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-xl custom-modal-width">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Attendance Report</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body" id="attendanceModalBody">
                <!-- Report info and export button will be injected here -->
            </div>
        </div>
    </div>
</div>
    <script>
        const Empid = parseInt(localStorage.getItem("EmployeeId"));
        const Role = localStorage.getItem("RoleSlug");
        const Token = localStorage.getItem("authToken");
        const savedCompany = localStorage.getItem('selectedCompany');
        const companyDetails = JSON.parse(savedCompany || '{}');
        const Compname = companyDetails.CompanyName;
        const CompanyId = companyDetails.CompanyId;

        // Global variable to store original employee data
        let originalEmployeeData = [];

        $(document).ready(function () {
            populateYearDropdown();
            BindBranchDropdown(); // Load branches on page load using your function
            $('#monthSelect').val(new Date().getMonth() + 1); // Set current month as default

            // Initially hide all data-related elements
            hideDataElements();
        });

        // Function to hide data-related elements
        function hideDataElements() {
            $('#recordCount').removeClass('show').hide();
            $('#searchViewContainer').removeClass('show').hide();
            $('#noDataMessage').show();
            $('#employeeAttendanceGrid').hide();
        }

        // Function to show data-related elements
        function showDataElements() {
            $('#recordCount').addClass('show').show();
            $('#searchViewContainer').addClass('show').show();
            $('#noDataMessage').hide();
            $('#employeeAttendanceGrid').show();
        }

        function goBack() {
            window.history.back(); // Navigates to the previous page
        }

        function populateYearDropdown() {
            const startYear = 2025;
            const currentYear = new Date().getFullYear();
            const yearDropdown = $("#yearSelect");
            yearDropdown.empty();
            for (let year = currentYear; year >= startYear; year--) {
                yearDropdown.append(`<option value="${year}">${year}</option>`);
            }
            yearDropdown.val(currentYear);
        }

        function BindBranchDropdown() {
            $.ajax({
                url: '@baseDomainUrl/api/BranchAPI/GetAllBranchesListByCompanyId/' + CompanyId,
                method: 'GET',
                headers: {
                    'Authorization': 'Bearer ' + Token
                },
                success: function (response) {
                    if (response?.data?.length > 0) {
                        $("#branchDropdown").dxTagBox({
                            items: response.data,
                            displayExpr: "branchName",
                            valueExpr: "branchId",
                            placeholder: "--Select Branch--",
                            showSelectionControls: true,
                            searchEnabled: true,
                            showClearButton: true,
                            maxDisplayedTags: 3,
                            applyValueMode: "instantly",
                            multiline: false,
                            minSearchLength: 0,
                            width: "100%",
                            onOpened: function () {
                                $(".dx-overlay-content").css("max-width", "150px");
                            },
                            onValueChanged: function (e) {
                                let selectedBranchIds = e.value.length > 0 ? e.value : [0];
                                // Don't auto load on branch selection - user needs to click Find
                            }
                        });
                    }
                },
                error: function () {
                    console.error('Failed to load branches');
                    Swal.fire('Error', 'Failed to load branches.', 'error');
                }
            });
        }

        function updateRecordCount() {
            const grid = $("#employeeAttendanceGrid").dxDataGrid("instance");
            if (grid) {
                const visibleRows = grid.getVisibleRows();
                const filteredCount = visibleRows.length;
                $('#recordCount').text(`${filteredCount} Records found.`);

                // Update record count color based on count
                if (filteredCount > 0) {
                    $('#recordCount').css('color', '#28a745'); // Green for records found
                } else {
                    $('#recordCount').css('color', '#dc3545'); // Red for no records
                }
            }
        }

        function onFind() {
            const branchTagBox = $("#branchDropdown").dxTagBox("instance");
            const selectedBranchIds = branchTagBox ? branchTagBox.option("value") : [];

            if (!selectedBranchIds || selectedBranchIds.length === 0) {
                Swal.fire('Warning', 'Please select at least one branch.', 'warning');
                return;
            }

            $('#grid-loader').addClass('d-flex').show();
            hideDataElements(); // Hide elements during loading

            // Convert array to comma-separated string for API
            const branchIdsParam = selectedBranchIds.join(',');

            $.ajax({
                url: `@baseDomainUrl/api/EmployeeMasterAPI/GetAllEmployee_DropDown/${CompanyId}?BranchId=${branchIdsParam}`,
                type: "GET",
                headers: {
                    'Authorization': 'Bearer ' + Token
                },
                dataType: "json",
                success: function (response) {
                    const employeeData = response.data || response;
                    originalEmployeeData = employeeData; // Store original data

                    if (employeeData && employeeData.length > 0) {
                     
                        showDataElements();

                        const grid = $("#employeeAttendanceGrid").dxDataGrid({
                            dataSource: employeeData,
                            keyExpr: "id",
                            selection: {
                                mode: "multiple",
                                showCheckBoxesMode: "always"
                            },
                            showBorders: true,
                            columnAutoWidth: true,
                            paging: {
                                enabled: false
                            },
                            scrolling: {
                                mode: "standard",
                                useNative: true,
                                showScrollbar: "always"
                            },
                            searchPanel: {
                                visible: false  // Hide the built-in search panel
                            },
                            height: 500,
                            columns: [
                                { dataField: "employeeCode", caption: "Employee Code", width: 150 },
                                { dataField: "id", caption: "EmployeeId", visible: false },
                                { dataField: "fullName", caption: "Employee Name" },
                                { dataField: "branchName", caption: "Branch", width: 150 }
                            ],
                            onContentReady: function() {
                                updateRecordCount(); // Update count when grid is ready
                            }
                        }).dxDataGrid("instance");

                        // Custom search functionality with count update
                        $('#employeeSearch').off('input').on('input', function() {
                            const searchValue = $(this).val();
                            if (searchValue) {
                                grid.filter([
                                    ['fullName', 'contains', searchValue],
                                    'or',
                                    ['employeeCode', 'contains', searchValue],
                                    'or',
                                    ['branchName', 'contains', searchValue]
                                ]);
                            } else {
                                grid.clearFilter();
                            }
                            // Update record count after filtering
                            setTimeout(updateRecordCount, 100);
                        });

                        const recordCount = employeeData.length;
                        $('#recordCount').text(`${recordCount} Records found.`);
                        $('#recordCount').css('color', '#28a745'); // Green for found records
                    } else {
                        // No data found
                        hideDataElements();
                        $('#noDataMessage').text('No employees found for the selected branch(es).').show();
                    }

                    $('#grid-loader').removeClass('d-flex').hide();
                },
                error: function () {
                    $('#grid-loader').removeClass('d-flex').hide();
                    hideDataElements();
                    $('#noDataMessage').text('Failed to load employees. Please try again.').show();
                    Swal.fire('Error', 'Failed to load employees.', 'error');
                }
            });
        }

        function onClear() {
            const branchTagBox = $("#branchDropdown").dxTagBox("instance");
            if (branchTagBox) {
                branchTagBox.option("value", []);
            }
            $('#monthSelect').val(new Date().getMonth() + 1);
            $('#yearSelect').val(new Date().getFullYear());

            // Clear grid if it exists
            const grid = $("#employeeAttendanceGrid").dxDataGrid("instance");
            if (grid) {
                grid.option("dataSource", []);
            }

            // Hide all data-related elements and show default message
            hideDataElements();
            $('#noDataMessage').text('No data to display. Please select a branch and click Find to load employee data.');
            $('#employeeSearch').val(''); // Clear search input
            originalEmployeeData = []; // Clear original data
        }

        $('#btnView').on('click', function () {
       
            const branchTagBox = $("#branchDropdown").dxTagBox("instance");
            const selectedBranchIds = branchTagBox ? branchTagBox.option("value") : [];

            if (!selectedBranchIds || selectedBranchIds.length === 0) {
                Swal.fire('Warning', 'Please select at least one branch.', 'warning');
                return;
            }

            var selectedYear = $('#yearSelect').val();
            var selectedMonth = $('#monthSelect').val();

            const month = parseInt(selectedMonth);
            const year = parseInt(selectedYear);

            const grid = $('#employeeAttendanceGrid').dxDataGrid("instance");
            const selected = grid.getSelectedRowsData();

            if (!selected.length) {
                Swal.fire('Warning', 'Select at least one employee.', 'warning');
                return;
            }

            const empCodes = selected.map(emp => emp.id);

            const paddedMonth = String(month).padStart(2, '0');
            const startDate = `${year}-${paddedMonth}-01`;
            const lastDay = new Date(year, month, 0).getDate();
            const endDate = `${year}-${paddedMonth}-${lastDay}`;

            const request = {
                StartDate: startDate,
                EndDate: endDate,
                EmployeeIds: empCodes
         
            };

            $.ajax({
                url: '@(baseDomainUrl + "/api/EmployeeReportAPI/Attendencereport")',
                method: 'POST',
                contentType: 'application/json',
                headers: {
                    'Authorization': 'Bearer ' + Token
                },
                data: JSON.stringify(request),
                success: function (res) {
         
                    if (!res || !res.data || res.data.length === 0) {
                        $('#attendanceModalBody').html('<p class="text-danger">No attendance records found.</p>');
                        const modal = new bootstrap.Modal(document.getElementById('attendanceModal'));
                        modal.show();
                        return;
                    }

                    renderAttendanceTable(res.data, startDate, endDate);
                },
                error: function () {
                    Swal.fire('Error', 'Something went wrong while fetching data.', 'error');
                }
            });
        });



    function renderAttendanceTable(data, startDate, endDate) {
    
        const dayRow = data[0];
        const dayKeys = Object.keys(dayRow.days).sort((a, b) => parseInt(a) - parseInt(b));

        const formatDate = (dateStr) => {
            const [yyyy, mm, dd] = dateStr.split("-");
            return `${dd}-${mm}-${yyyy}`;
        };
        const today = formatDate(new Date().toISOString().split('T')[0]);

        // Get selected branch names for report header
        const branchTagBox = $("#branchDropdown").dxTagBox("instance");
        const selectedBranchIds = branchTagBox ? branchTagBox.option("value") : [];
        const allBranches = branchTagBox ? branchTagBox.option("items") : [];
        const selectedBranchNames = allBranches
            .filter(branch => selectedBranchIds.includes(branch.branchId))
            .map(branch => branch.branchName)
            .join(', ');

        let header = `
            <div class="d-flex justify-content-between align-items-center mb-3">
                <div id="reportInfo">
                    <strong>Company:</strong> ${Compname} &nbsp;&nbsp;
                    <strong>From:</strong> ${formatDate(startDate)} &nbsp;&nbsp;
                    <strong>To:</strong> ${formatDate(endDate)} &nbsp;&nbsp;
                    <strong>Print Date:</strong> ${today}
                </div>
                <button class="btn btn-success btn-sm" id="btnExportExcel">Export to Excel</button>
            </div>`;

        let html = `<div class="attendance-table-container">
            <table class="table table-bordered table-sm align-middle">
                <thead class="table-light text-center">
                    <tr>
                        <th class="text-nowrap">Branch</th>
                        <th class="text-nowrap">Emp Code</th>
                        <th class="text-nowrap" style="min-width: 180px;">Employee</th>`;

        dayKeys.forEach(day => {
            const dayLabel = `${day} (${dayRow.days[day]})`;
            html += `<th class="text-center" style="min-width: 45px;">${dayLabel}</th>`;
        });

        html += `
            <th class="text-nowrap">Total P</th>
            <th class="text-nowrap">Total A</th>
            <th class="text-nowrap">Total W</th>
            <th class="text-nowrap">Total L</th>
            <th class="text-nowrap">Total H</th>
            <th class="text-nowrap">Total HF</th>
        </tr>
        </thead>
        <tbody>`;

        for (let i = 0; i < data.length; i++) {
            const row = data[i];
            html += `<tr>
                <td>${row.branchName ?? ''}</td>
                <td>${row.employeeCode ?? ''}</td>
                <td>${row.fullName ?? ''}</td>`;

            // Day-wise attendance columns - ab saare A red honge
            dayKeys.forEach(day => {
                const value = row.days?.[day] ?? '';
                const trimmedValue = value.toString().trim().toUpperCase();
                const redClass = trimmedValue === 'A' ? 'text-danger fw-bold' : '';
                html += `<td class="text-center ${redClass}">${value}</td>`;
            });

            html += `
                <td class="text-center">${row.p ?? 0}</td>
                <td class="text-center text-danger fw-bold">${row.a ?? 0}</td>
                <td class="text-center">${row.w ?? 0}</td>
                <td class="text-center">${row.l ?? 0}</td>
                <td class="text-center">${row.h ?? 0}</td>
                <td class="text-center">${row.hF ?? 0}</td>
            </tr>`;
        }

        html += `</tbody></table></div>`;

        $('#attendanceModalBody').html(header + html);
        const modal = new bootstrap.Modal(document.getElementById('attendanceModal'));
        modal.show();
    }

        $(document).on('click', '#attendanceModal .btn-close', function () {
        clearFormAndSelection();
    });

    $('#attendanceModal').on('hidden.bs.modal', function () {
        clearFormAndSelection();
    });

    function clearFormAndSelection() {
        // Clear grid selection
        const grid = $('#employeeAttendanceGrid').dxDataGrid("instance");
        if (grid) {
            grid.clearSelection();
            console.log("Selection cleared");
        }

        // Clear branch dropdown
        const branchTagBox = $("#branchDropdown").dxTagBox("instance");
        if (branchTagBox) {
            branchTagBox.option("value", []);
        }

        // Reset month and year to current
        $('#monthSelect').val(new Date().getMonth() + 1);
        $('#yearSelect').val(new Date().getFullYear());

        // Clear search input
        $('#employeeSearch').val('');

        // Clear grid data
        if (grid) {
            grid.option("dataSource", []);
        }

        // Hide all data-related elements and show default message
        hideDataElements();
        $('#noDataMessage').text('No data to display. Please select a branch and click Find to load employee data.');

        // Clear original employee data
        originalEmployeeData = [];

        console.log("Form cleared successfully");
    }

        $(document).on('click', '#btnExportExcel', function () {
            const table = document.querySelector("#attendanceModalBody table");
            if (!table) {
                Swal.fire('Error', 'No table found to export.', 'error');
                return;
            }

            const workbook = new ExcelJS.Workbook();
            const worksheet = workbook.addWorksheet("Attendance");

            // Create table header row with styling
            const headerRow = [];
            table.querySelectorAll("thead tr th").forEach(th => {
                headerRow.push(th.innerText.trim());
            });
            worksheet.addRow(headerRow);

            // Apply style to header
            worksheet.getRow(1).eachCell(cell => {
                cell.font = { bold: true, color: { argb: 'FFFFFFFF' } };
                cell.fill = {
                    type: 'pattern',
                    pattern: 'solid',
                    fgColor: { argb: 'FF343A40' }
                };
                cell.alignment = { vertical: 'middle', horizontal: 'center' };
                cell.border = {
                    top: { style: 'thin' },
                    left: { style: 'thin' },
                    bottom: { style: 'thin' },
                    right: { style: 'thin' }
                };
            });

            // Add table rows
            table.querySelectorAll("tbody tr").forEach(tr => {
                const row = [];
                tr.querySelectorAll("td").forEach(td => {
                    row.push(td.innerText.trim());
                });
                worksheet.addRow(row);
            });

            // Apply border to all data cells
            worksheet.eachRow((row, rowNumber) => {
                row.eachCell(cell => {
                    cell.border = {
                        top: { style: 'thin' },
                        left: { style: 'thin' },
                        bottom: { style: 'thin' },
                        right: { style: 'thin' }
                    };
                });
            });

            // Auto width for columns
            worksheet.columns.forEach(column => {
                let maxLength = 10;
                column.eachCell({ includeEmpty: true }, cell => {
                    const length = cell.value ? cell.value.toString().length : 10;
                    if (length > maxLength) {
                        maxLength = length;
                    }
                });
                column.width = maxLength + 2;
            });

            // Save file
            workbook.xlsx.writeBuffer().then(buffer => {
                const now = new Date();
                const fileName = `Attendance_Report_${now.getFullYear()}-${now.getMonth() + 1}-${now.getDate()}.xlsx`;
                const blob = new Blob([buffer], { type: "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" });
                saveAs(blob, fileName);
            });
        });

    </script>
