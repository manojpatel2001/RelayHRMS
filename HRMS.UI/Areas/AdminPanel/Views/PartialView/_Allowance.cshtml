@inject IConfiguration Configuration
@{
    Layout = null;
    string baseUrl = Configuration["BaseUrlSettings:baseUrl"];

}
    <style>
     

      

        .header {
            text-align: center;
            margin-bottom: 30px;
        }

            .header h1 {
                color: #2c3e50;
                font-size: 2.5em;
                margin-bottom: 10px;
                font-weight: 700;
            }

            .header p {
                color: #7f8c8d;
                font-size: 1.1em;
                margin: 0;
            }

        .table-container {
            margin-bottom: 30px;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }

        table {
            width: 100%;
            border-collapse: collapse;
            background: white;
        }

        .section-header {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
            font-weight: 600;
            font-size: 1.1em;
            text-align: center;
            padding: 15px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .earnings-header {
            background: linear-gradient(135deg, #27ae60, #2ecc71);
        }

        .deductions-header {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
        }

        .ctc-header {
            background: linear-gradient(135deg, #8e44ad, #9b59b6);
        }

        th {
            background: linear-gradient(135deg, #34495e, #2c3e50);
            color: white;
            padding: 12px;
            font-weight: 600;
            text-align: left;
            border-bottom: 2px solid #ecf0f1;
        }

        td {
            padding: 12px;
            border-bottom: 1px solid #ecf0f1;
            transition: background-color 0.3s ease;
        }

      /*   tr:hover td {
            background-color: #f8f9fa;
        } */

        .component-name {
            color: #2c3e50;
        }

       

        .fixed {
            color: #27ae60;
            font-weight: 600;
        }

        .variable {
            color: #e67e22;
        }

        .amount {
            font-weight: 600;
            color: #2c3e50;
        }

        .total-row {
            background: linear-gradient(135deg, #f39c12, #e67e22);
            color: white;
            
        }

            .total-row td {
                border-bottom: none;
            }

        .net-salary-row {
            background: linear-gradient(135deg, #27ae60, #2ecc71);
            color: white;
           
        }

        .ctc-row {
            background: linear-gradient(135deg, #8e44ad, #9b59b6);
            color: white;
          
        }

        .summary-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }

        .summary-card {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }

            .summary-card h4 {
                margin: 0 0 10px 0;
                opacity: 0.9;
            }

            .summary-card .amount {
                font-size: 1.8em;
                font-weight: 700;
                color: white;
            }

     
        .SalaryContainer
        {
            margin: 10px;
        }

        table {
            font-size: 0.9em;
        }

        .header h1 {
            font-size: 2em;
        }

        .summary-cards {
            grid-template-columns: 1fr;
        }

        
    </style>

<div class="SalaryContainer">
    <div id="SalaryContainer">
        <div class="header">
            <h3>💰 Salary Breakdown Report</h3>
            <p>Monthly Gross Salary: <span id="monthlyGross"></span> | Annual Package: <span id="AnualGross"></span></p>
        </div>
        <!-- Earnings Section -->
        <div class="table-container">
            <table>
                <tr class="section-header earnings-header">
                    <td colspan="4">💼 SALARY COMPONENTS & EARNINGS</td>
                </tr>
                <tr>
                    <th>Component</th>
                    <th>Per Month (₹)</th>
                    <th>Per Annum (₹)</th>
                </tr>
                <tr>
                    <td class="component-name">Basic Salary</td>
                    <td id="basicSalaryMonth" class="amount"></td>
                    <td id="basicSalaryYear" class="amount"></td>
                </tr>
                <tr>
                    <td class="component-name">HRA (Housing Rent Allowance)</td>
                    <td id="hraMonth" class="amount"></td>
                    <td id="hraYear" class="amount"></td>
                </tr>
                <tr>
                    <td class="component-name">Deputation Allowance</td>
                    <td id="deputationAllowanceMonth" class="amount"></td>
                    <td id="deputationAllowanceYear" class="amount"></td>
                </tr>
                <tr>
                    <td class="component-name">Conveyance Allowance</td>
                    <td id="conveyanceAllowanceMonth" class="amount"></td>
                    <td id="conveyanceAllowanceYear" class="amount"></td>
                </tr>
                <tr>
                    <td class="component-name">Medical Allowance</td>
                    <td id="medicalAllowanceMonth" class="amount"></td>
                    <td id="medicalAllowanceYear" class="amount"></td>
                </tr>
                <tr>
                    <td class="component-name">Child Education Allowance</td>
                    <td id="childEducationAllowanceMonth" class="amount"></td>
                    <td id="childEducationAllowanceYear" class="amount"></td>
                </tr>
                <tr class="total-row">
                    <td><strong>TOTAL GROSS SALARY</strong></td>
                    <td id="totalGrossMonth" class="amount"><strong></strong></td>
                    <td id="totalGrossYear" class="amount"><strong></strong></td>
                </tr>
            </table>
        </div>
        <!-- Deductions Section -->
        <div class="table-container">
            <table>
                <tr class="section-header deductions-header">
                    <td colspan="4">📉 DEDUCTIONS</td>
                </tr>
                <tr>
                    <th>Deduction Type</th>
                    <th>Per Month (₹)</th>
                    <th>Per Annum (₹)</th>
                </tr>
                <tr>
                    <td class="component-name">Provident Fund (PF)</td>
                    <td id="pfMonth" class="amount"></td>
                    <td id="pfYear" class="amount"></td>
                </tr>
                <tr>
                    <td class="component-name">ESI Contribution</td>
                    <td id="esiMonth" class="amount"></td>
                    <td id="esiYear" class="amount"></td>
                </tr>
                <tr>
                    <td class="component-name">Professional Tax (PT)</td>
                    <td id="ptMonth" class="amount"></td>
                    <td id="ptYear" class="amount"></td>
                </tr>
                <tr>
                    <td class="component-name">Group Medical Insurance</td>
                    <td id="groupMedicalMonth" class="amount"></td>
                    <td id="groupMedicalYear" class="amount"></td>
                </tr>
                <tr>
                    <td class="component-name">Term Insurance</td>
                    <td id="termInsuranceMonth" class="amount"></td>
                    <td id="termInsuranceYear" class="amount"></td>
                </tr>
                <tr class="total-row">
                    <td><strong>TOTAL DEDUCTIONS</strong></td>
                    <td id="totalDeductionMonth" class="amount"><strong></strong></td>
                    <td id="totalDeductionYear" class="amount"><strong></strong></td>
                </tr>
                <tr class="net-salary-row">
                    <td><strong>NET SALARY (Take Home)</strong></td>
                    <td id="netSalaryMonth" class="amount"><strong></strong></td>
                    <td id="netSalaryYear" class="amount"><strong></strong></td>
                </tr>
            </table>
        </div>
        <!-- CTC Calculation Section -->
        <div class="table-container">
            <table>
                <tr class="section-header ctc-header">
                    <td colspan="4">📊 CTC CALCULATION</td>
                </tr>
                <tr>
                    <th>Component</th>
                    <th>Per Month (₹)</th>
                    <th>Per Annum (₹)</th>
                </tr>
                <tr>
                    <td class="component-name">Gross Salary</td>
                    <td id="CalculationGrossMonth" class="amount"></td>
                    <td id="CalculationGrossYear" class="amount"></td>
                </tr>
                <tr>
                    <td  class="component-name">Employer PF Contribution</td>
                    <td id="CalculationPFMonth" class="amount"></td>
                    <td id="CalculationPFYear"  class="amount"></td>
                </tr>
                <tr>
                    <td class="component-name">Employer ESI Contribution</td>
                    <td id="CalculationESIMonth"  class="amount"></td>
                    <td id="CalculationESIMonth"  class="amount"></td>
                </tr>
                <tr class="ctc-row">
                    <td><strong>TOTAL CTC</strong></td>
                    <td id="ctcMonth" class="amount"><strong></strong></td>
                    <td id="ctcYear" class="amount"><strong></strong></td>
                </tr>
            </table>
        </div>
        <!-- Summary Cards -->
        <div class="summary-cards">
            <div class="summary-card">
                <h3>💼 Monthly CTC</h3>
                <div id="summaryCtc" class="amount"></div>
            </div>
            <div class="summary-card">
                <h3>💰 Take Home Salary</h3>
                <div id="summaryNet" class="amount"></div>
            </div>
            <div class="summary-card">
                <h3>📈 Annual Package</h3>
                <div id="summaryAnnual" class="amount"></div>
            </div>
        </div>
    </div>
    <div id="salaryNoFound" style="display:none;">No Record Found!</div>
</div>


<script>


    $(document).ready(function(){
        loadLiveSalaryAllowance();
    });
     $('#txtGrossSalary , #txtBasicSalary').blur(async function () {
        await loadLiveSalaryAllowance();

    });
    async function loadLiveSalaryAllowance() {
        var grossSalary = $('#txtGrossSalary').val();
        var basicSalary = $('#txtBasicSalary').val();
        var isPFApplicable = $('#isPFApplicable').is(':checked');
        if (basicSalary == null || basicSalary === '') {
            basicSalary = 0;
        }

        if(!grossSalary)
        {
            $("#SalaryContainer").hide();
            $("#salaryNoFound").show();
            return;
        }
           try {
                    const response = await fetch('@baseUrl/EmployeeSalaryAllowanceAPI/GetLiveEmployeeSalaryAllowance', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({
                            IsPFApplicable: isPFApplicable,
                            GrossSalary: grossSalary,
                                    BasicSalary: basicSalary
                        })
                    });

            const data = await response.json();
            if (data.isSuccess) {
                var arrayDta = data.data;
                      $("#SalaryContainer").show();
                      $("#salaryNoFound").hide();
                  bindSalaryAllowance(arrayDta);


            }
            else{
                        $("#SalaryContainer").hide();
                    $("#salaryNoFound").show();
                }
        } catch (error) {
            console.error('Fetch error:', error);
        }
    }



        function formatCurrency(value) {
            return "₹" + (value ?? 0).toFixed(2);
        }

    function bindSalaryAllowance(salaryData) {

        $('#monthlyGross').text(formatCurrency(salaryData.totalGrossSalary));
        $('#AnualGross').text(formatCurrency(salaryData.totalGrossSalary * 12));
            $('#txtBasicSalary').val(salaryData.basicSalary);
                    $('#txtctcSalary').val(salaryData.ctc);
        $('#basicSalaryMonth').text(formatCurrency(salaryData.basicSalary));
        $('#basicSalaryYear').text(formatCurrency(salaryData.basicSalary * 12));
        $('#hraMonth').text(formatCurrency(salaryData.hra));
        $('#hraYear').text(formatCurrency(salaryData.hra * 12));
        $('#deputationAllowanceMonth').text(formatCurrency(salaryData.deputationAllowance));
        $('#deputationAllowanceYear').text(formatCurrency(salaryData.deputationAllowance * 12));
        $('#conveyanceAllowanceMonth').text(formatCurrency(salaryData.conveyanceAllowance));
        $('#conveyanceAllowanceYear').text(formatCurrency(salaryData.conveyanceAllowance * 12));
        $('#medicalAllowanceMonth').text(formatCurrency(salaryData.medicalAllowance));
        $('#medicalAllowanceYear').text(formatCurrency(salaryData.medicalAllowance * 12));
        $('#childEducationAllowanceMonth').text(formatCurrency(salaryData.childEducationAllowance));
        $('#childEducationAllowanceYear').text(formatCurrency(salaryData.childEducationAllowance * 12));
        $('#totalGrossMonth').text(formatCurrency(salaryData.totalGrossSalary));
        $('#totalGrossYear').text(formatCurrency(salaryData.totalGrossSalary * 12));

        // Deductions
        $('#pfMonth').text(formatCurrency(salaryData.employeePF));
        $('#pfYear').text(formatCurrency(salaryData.employeePF * 12));
        $('#esiMonth').text(formatCurrency(salaryData.employeeESI));
        $('#esiYear').text(formatCurrency(salaryData.employeeESI * 12));
        $('#ptMonth').text(formatCurrency(salaryData.professionalTax));
        $('#ptYear').text(formatCurrency(salaryData.professionalTax * 12));
        $('#groupMedicalMonth').text(formatCurrency(salaryData.groupMedical));
        $('#groupMedicalYear').text(formatCurrency(salaryData.groupMedical * 12));
        $('#termInsuranceMonth').text(formatCurrency(salaryData.termInsurance));
        $('#termInsuranceYear').text(formatCurrency(salaryData.termInsurance * 12));
        $('#totalDeductionMonth').text(formatCurrency(salaryData.totalDeductions));
        $('#totalDeductionYear').text(formatCurrency(salaryData.totalDeductions * 12));

        // Net Salary
        $('#netSalaryMonth').text(formatCurrency(salaryData.netSalary));
        $('#netSalaryYear').text(formatCurrency(salaryData.netSalary * 12));

        // CTC calculation
        $('#CalculationGrossMonth').text(formatCurrency(salaryData.ctc));
        $('#CalculationGrossYear').text(formatCurrency(salaryData.ctc * 12));
        $('#CalculationPFMonth').text(formatCurrency(salaryData.employeePF));
        $('#CalculationPFYear').text(formatCurrency(salaryData.employeePF * 12));
        $('#CalculationESIMonth').text(formatCurrency(salaryData.employeeESI));
        $('#CalculationESIMonth').text(formatCurrency(salaryData.employeeESI * 12));
        // CTC
        $('#ctcMonth').text(formatCurrency(salaryData.ctc));
        $('#ctcYear').text(formatCurrency(salaryData.ctc * 12));

        // Summary
        $('#summaryCtc').text(formatCurrency(salaryData.ctc));
        $('#summaryNet').text(formatCurrency(salaryData.netSalary));
        $('#summaryAnnual').text(formatCurrency(salaryData.ctc * 12));
    }



</script>


