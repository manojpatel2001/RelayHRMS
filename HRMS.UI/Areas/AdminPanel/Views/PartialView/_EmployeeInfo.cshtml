@inject IConfiguration Configuration
@{
    Layout = null;
    string baseUrl = Configuration["BaseUrlSettings:baseUrl"];

}


    <div class="card-header bg-primary text-white ">
    <h6>EMPLOYEE PERSONAL DETAILS   [Employee Age : <span id="empAge"></span>]</h6>
    </div>


<div id="editSection" >
    <div class="card-body px-4">
        @* <div class="row loaderTag">
            <div class="d-flex justify-content-center align-items-center " style="height: 10vh;display:none;" >
                <div class="spinner-border text-primary" role="status">
                    <span class="visually-hidden">Loading...</span>
                </div>
            </div>
        </div> *@
      <form id="employeeForm">
            <div class="row">
                <div class="col-md-12 mb-2"><h6><b>Personal Information:</b></h6></div>
            </div>

            <!-- Personal Information Fields (Editable) -->
            <div class="row px-5">
                <div class="col-md-4">
                    <div class="form-group mt-3 position-relative">
                        <input type="hidden" class="form-control floating-input" id="EmployeePersonalInfoId" placeholder=" ">
                            <select class="form-control floating-input" id="ddlGender">
                                <option selected >Male</option>
                                <option >Female</option>

                            </select>
                        <label class="floating-label" for="ddlGender">Gender</label>
                        <span id="spnGender" style="color:red; display:none;">Please Enter Gender</span>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="form-group mt-3 position-relative">
                        <input type="email" class="form-control floating-input" placeholder="Personal Email ID" id="inpPersonalEmailId" />
                        <label class="floating-label" for="inpPersonalEmailId">Personal Email ID</label>
                        <span id="spnPersonalEmailId" style="color:red; display:none;">Please Enter Personal Email ID</span>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="form-group mt-3 position-relative">
                        <input type="text" class="form-control floating-input" placeholder="Father Name" id="inpFatherName" />
                        <label class="floating-label" for="inpFatherName">Father Name</label>
                        <span id="spnFatherName" style="color:red; display:none;">Please Enter Father Name</span>
                    </div>
                </div>

                <div class="col-md-4">
                    <div class="form-group mt-3 position-relative">
                        <input type="text" class="form-control floating-input" placeholder="Mother Name" id="inpMotherName" />
                        <label class="floating-label" for="inpMotherName">Mother Name</label>
                        <span id="spnMotherName" style="color:red; display:none;">Please Enter Mother Name</span>
                    </div>
                </div>

              
                <div class="col-md-4">
                    <div class="form-group mt-3 position-relative">
                        <select class="form-control floating-input" id="ddlBloodGroup">
                            <option selected disabled value="">Select Blood Group</option>
                                <option >A+VE</option>
                                <option >A-VE</option>
                                <option >B+VE</option>
                                <option >B-VE</option>
                                <option >AB+VE</option>
                                <option >AB-VE</option>
                                <option >O+VE</option>
                                <option >O-VE</option>
                                <option >A1+VE</option>
                                <option >A1-VE</option>
                                <option >A1B+VE</option>
                                <option >A1B-VE</option>
                                <option >A2+VE</option>
                                <option >A2-VE</option>
                                <option >A2B+VE</option>
                                <option >A2B-VE</option>
                                <option >B1+VE</option>
                                <option >B2-VE</option>

                        </select>

                        <label class="floating-label" for="ddlBloodGroup">Blood Group</label>
                        <span id="spnBloodGroup" style="color:red; display:none;">Please Enter Blood Group</span>
                    </div>
                </div>

                <!-- Additional Fields -->
                <div class="col-md-4">
                    <div class="form-group mt-3 position-relative">
                        <input type="text" class="form-control floating-input" placeholder="Height" id="inpHeight" />
                        <label class="floating-label" for="inpHeight">Height</label>
                        <span id="spnHeight" style="color:red; display:none;">Please Enter Height</span>
                    </div>
                </div>

                <div class="col-md-4">
                    <div class="form-group mt-3 position-relative">
                        <select class="form-control floating-input" id="ddlMaritalStatus">
                            <option selected disabled value="">Select Marital Status</option>
                            <option>Married</option>
                            <option>Single</option>
                            <option >Divorced</option>
                            <option >Separated</option>
                            <option >Widowed</option>
                        </select>
                        <label class="floating-label" for="ddlMaritalStatus">Marital Status </label>
                        <span id="spnMaritalStatus" style="color:red; display:none;">Please Enter Marital Status</span>
                    </div>
                  
                </div>

                <div class="col-md-4">
                    <div class="form-group mt-3 position-relative">
                        <input type="date" class="form-control floating-input" id="inpMarriageDate" />
                        <label class="floating-label" for="inpMarriageDate">Marriage Date</label>
                        <span id="spnMarriageDate" style="color:red; display:none;">Please Enter Marriage Date</span>
                    </div>
                </div>

                <div class="col-md-4">
                    <div class="form-group mt-3 position-relative">
                        <input type="text" class="form-control floating-input" placeholder="Mark Identification" id="inpMarkIdentification" />
                        <label class="floating-label" for="inpMarkIdentification">Mark Identification</label>
                        <span id="spnMarkIdentification" style="color:red; display:none;">Please Enter Mark Identification</span>
                    </div>
                </div>

                <div class="col-md-4">
                    <div class="form-group mt-3 position-relative">
                        <input type="text" class="form-control floating-input" placeholder="Religion" id="inpReligion" />
                        <label class="floating-label" for="inpReligion">Religion</label>
                        <span id="spnReligion" style="color:red; display:none;">Please Enter Religion</span>
                    </div>
                </div>

                <div class="col-md-4 ">
                    <div class="form-group mt-3  position-relative">
                        <input type="text" class="form-control floating-input" placeholder="Caste" id="inpCaste" />
                        <label class="floating-label" for="inpCaste">Caste</label>
                    </div>
                </div>

                <div class="col-md-4">
                    <div class="form-group mt-3 position-relative">
                        <select class="form-control floating-input" id="ddlCasteCategory">
                              <option selected disabled value="">Select Category</option>
                                <option >ST</option>
                                <option >OBC</option>
                                <option >SC</option>
                                <option >SBC</option>
                                <option >OPEN</option>
                                <option >VJNT</option>
                                <option >Other</option>
                        </select>
                        <label class="floating-label" for="ddlCasteCategory">Cast Category</label>
                    </div>
                </div>
            </div>

        <hr/>

            <div class="row">
                <div class="col-md-12 mb-2">
                    <h6><b>Require Document:</b></h6>
                </div>
            </div>

            <div class="row px-5">
                <div class="col-md-4 mb-2">
                    <div class="form-group mt-3 position-relative">
                        <input type="text" class="form-control floating-input" placeholder="Aadhar Card No" id="inpAadharCardNo" />
                        <label class="floating-label" for="inpAadharCardNo">Aadhar Card No</label>
                        <span id="spnAadharCardNo" style="color:red; display:none;">Please Enter Aadhar Card No</span>
                    </div>
                </div>

                <div class="col-md-4 mb-2">
                    <div class="form-group mt-3 position-relative">
                        <input type="text" class="form-control floating-input" placeholder="PAN No" id="inpPanNo" />
                        <label class="floating-label" for="inpPanNo">PAN No</label>
                        <span id="spnPanNo" style="color:red; display:none;">Please Enter PAN No</span>
                    </div>
                </div>

                <div class="col-md-4 mb-2">
                    <div class="form-group mt-3 position-relative">
                        <input type="text" class="form-control floating-input" placeholder="Dispensary" id="inpDispensary" />
                        <label class="floating-label" for="inpDispensary">Dispensary</label>
                        <span id="spnDispensary" style="color:red; display:none;">Please Enter Dispensary Name</span>
                    </div>
                </div>
            </div>

            <div class="row px-5">
                <div class="col-md-4 mb-2">
                    <div class="form-group mt-3 position-relative">
                        <input type="text" class="form-control floating-input" placeholder="Doctor Name" id="inpDoctorName" />
                        <label class="floating-label" for="inpDoctorName">Doctor Name</label>
                        <span id="spnDoctorName" style="color:red; display:none;">Please Enter Doctor Name</span>
                    </div>
                </div>

                <div class="col-md-4 mb-2">
                    <div class="form-group mt-3 position-relative">
                        <input type="text" class="form-control floating-input" placeholder="Dispensary Address" id="inpDispensaryAddress" />
                        <label class="floating-label" for="inpDispensaryAddress">Dispensary Address</label>
                        <span id="spnDispensaryAddress" style="color:red; display:none;">Please Enter Dispensary Address</span>
                    </div>
                </div>

                <div class="col-md-4 mb-2">
                    <div class="form-group mt-3 position-relative">
                        <input type="text" class="form-control floating-input" placeholder="UAN Number" id="inpUanNumber" />
                        <label class="floating-label" for="inpUanNumber">UAN Number</label>
                        <span id="spnUanNumber" style="color:red; display:none;">Please Enter UAN Number</span>
                    </div>
                </div>

                <div class="col-md-4 mb-2">
                    <div class="form-group mt-3 position-relative">
                        <input type="text" class="form-control floating-input" placeholder="PF No" id="inpPFNo"  />
                        <label class="floating-label" for="inpPFNo">PF No</label>
                    </div>
                </div>
                <div class="col-md-4 mb-2">
                    <div class="form-group mt-3 position-relative">
                        <input type="text" class="form-control floating-input" placeholder="ESIC No" id="inpESICNo"  />
                        <label class="floating-label" for="inpUanNumber">ESIC No</label>
                    </div>
                </div>
            
                <div class="col-md-4 mb-2">
                    <div class="form-group mt-3 position-relative">
                        <input type="text" class="form-control floating-input" placeholder="No of Children" id="inpNoOfChildren" />
                        <label class="floating-label" for="inpNoOfChildren">No of Children</label>
                    </div>
                </div>

                <div class="col-md-4 mb-2">
                    <div class="form-group mt-3 position-relative">
                        <input type="text" class="form-control floating-input" placeholder="Driving License" id="inpDrivingLicense" />
                        <label class="floating-label" for="inpDrivingLicense">Driving License</label>
                        <span id="spnDrivingLicense" style="color:red; display:none;">Please Enter Driving License Number</span>
                    </div>
                </div>

                <div class="col-md-4 mb-2">
                    <div class="form-group mt-3 position-relative">
                        <input type="date" class="form-control floating-input" id="inpDrivingLicenseExpiry" />
                        <label class="floating-label" for="inpDrivingLicenseExpiry">Expiry Date of Driving License</label>
                        <span id="spnDrivingLicenseExpiry" style="color:red; display:none;">Please Enter Expiry Date</span>
                    </div>
                </div>

                <div class="col-md-4 mb-2">
                    <div class="form-group mt-3 position-relative">
                        <select class="form-control floating-input" id="ddlRationCardType">
                            <option selected disabled  value="">Select</option>
                            <option >APL</option>
                            <option >BPL</option>
                        </select>
                        <label class="floating-label" for="ddlRationCardType">Ration Card Type</label>
                        <span id="spnRationCardType" style="color:red; display:none;">Please Enter Ration Card Type</span>
                    </div>
                </div>
           
                <div class="col-md-4 mb-2">
                    <div class="form-group mt-3 position-relative">
                        <input type="text" class="form-control floating-input" placeholder="Ration Card No" id="inpRationCardNo" />
                        <label class="floating-label" for="inpRationCardNo">Ration Card No</label>
                        <span id="spnRationCardNo" style="color:red; display:none;">Please Enter Ration Card No</span>
                    </div>
                </div>
            </div>


         @*    <hr/>
            <div class="row">
                <div class="col-md-12 mb-2">
                    <h6><b>Social Address:</b></h6>
                </div>
            </div>

            <div class="row px-5">
                <div class="col-md-6 mb-2">
                    <div class="form-group mt-3 position-relative">
                        <input type="text" class="form-control floating-input" placeholder="LinkedIn ID" id="inpLinkedInId" />
                        <label class="floating-label" for="inpLinkedInId">LinkedIn ID</label>
                        <span id="spnLinkedInId" style="color:red; display:none;">Please Enter LinkedIn ID</span>
                    </div>
                </div>

                <div class="col-md-6 mb-2">
                    <div class="form-group mt-3 position-relative">
                        <input type="text" class="form-control floating-input" placeholder="Twitter ID" id="inpTwitterId" />
                        <label class="floating-label" for="inpTwitterId">Twitter ID</label>
                        <span id="spnTwitterId" style="color:red; display:none;">Please Enter Twitter ID</span>
                    </div>
                </div>
            </div> *@

            <hr/>

            <div class="row">
                <div class="col-md-12 mb-2">
                    <h6><b>Training and Probation:</b></h6>
                </div>
            </div>

            <div class="row px-5">
                <div class="col-md-8">
                    <div class="row">
                        <div class="col-5 mt-2">
                            Probation Completion Period:
                        </div>
                        <div class="col-2 ">
                            <div class="form-group mb-1 position-relative">
                                <input type="text" class="form-control " id="inpProbationCompletionPeriod" value="0" data-decimal/>
                            </div>
                                 <span id="spnProbationCompletionPeriod" style="color:red; display:none;">Please Enter Duration</span>


                        </div>
                        <div class="col-2 mt-2">
                            <input type="radio" name="day" checked id="probationMonth" value="Months" />
                            Months
                        </div>
                        <div class="col-3 mt-2">
                            <input type="radio" name="day" id="probationDay" value="Days" />
                             Days
                        </div>
                    </div>
                   
                </div>

                <div class="col-md-4">
                    @* <div class="form-group  position-relative">
                        <select class="form-control floating-input" id="ddlManagerProbation">
                            <option selected disabled value="">select</option>
                            
                        </select>
                        <label class="floating-label" for="ddlManagerProbation">Manager (Probation)</label>
                    </div>
                            <span id="spnddlManagerProbation" style="color:red; display:none;">Please Select Probation Manager</span> *@

                    <div class="mt-3 form-floating-custom">
                        <div class="searchable-select-wrapper" id="reportingWrapper">
                            <label for="ddlManagerProbation">Manager (Probation) <span class="text-danger">*</span></label>
                            <input type="text" class="searchable-select-input" id="ddlManagerProbation" readonly>
                            <span class="searchable-select-arrow">
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16">
                                    <path d="M7.247 11.14 2.451 5.658C1.885 5.013 2.345 4 3.204 4h9.592a1 1 0 0 1 .753 1.659l-4.796 5.48a1 1 0 0 1-1.506 0z" />
                                </svg>
                            </span>
                            <div class="searchable-select-dropdown">
                                <div class="searchable-select-search">
                                    <input type="text" placeholder="Search reporting manager..." class="search-input">
                                </div>
                                <div class="searchable-select-options"></div>
                            </div>
                        </div>
                            <span id="spnddlManagerProbation" style="color:red; display:none;">Please Select Probation Manager</span> 
                    </div>
                </div>

                <div class="col-md-4">
                    <div class="form-group mt-3 position-relative">
                        <input type="date" class="form-control floating-input" placeholder="Confirm Date" id="inpConfirmDate"   />
                        <label class="floating-label" for="inpConfirmDate">Confirm Date</label>
                        <span id="spnConfirmDate" style="color:red; display:none;">Please Enter Confirm Date</span>
                    </div>
                </div>

                <div class="col-md-4">
                    <div class="form-group mt-3 position-relative">
                        <input type="date" class="form-control floating-input" placeholder="Date of Retirement" id="inpRetirementDate"  />
                        <label class="floating-label" for="inpRetirementDate">Date of Retirement</label>
                        <span id="spnRetirementDate" style="color:red; display:none;">Please Enter Date of Retirement</span>
                    </div>
                </div>

                <div class="col-md-4 mb-3">
                    <div class="form-group mt-3 position-relative">
                        <input type="date" class="form-control floating-input" placeholder="Offer Date" id="inpOfferDate"  />
                        <label class="floating-label" for="inpOfferDate">Offer Date</label>
                        <span id="spnOfferDate" style="color:red; display:none;">Please Enter Offer Date</span>
                    </div>
                </div>

                <div class="col-md-8">
                    <div class="row">
                        <div class="col-5 mt-2">
                            Trainee Completion Period:
                        </div>
                        <div class="col-2">
                            <div class="form-group mb-1 position-relative">
                                <input type="text" class="form-control " data-decimal id="inpTraineeCompletionPeriod" value="0" />
                            </div>

                        </div>
                        <div class="col-2 mt-2">
                            <input type="radio" name="traininPeriod" checked id="monthsTraineeCompletionPeriod" value="Months" />
                            Months
                        </div>
                        <div class="col-3 mt-2">
                            <input type="radio" name="traininPeriod" id="daysTraineeCompletionPeriod" value="Days" />
                            Days
                        </div>
                    </div>

                </div>
                
            </div>
            <hr />

          @*   <div class="row">
                <div class="col-md-12 mb-2">
                    <h6><b>Other Detail:</b></h6>
                </div>
            </div>

            <div class="row px-5">
                <div class="col-md-4">
                    <div class="form-group mt-3 position-relative">
                        <input type="text" class="form-control floating-input" placeholder="Canteen Code" id="inpCanteenCode" />
                        <label class="floating-label" for="inpCanteenCode">Canteen Code</label>
                    </div>
                </div>

                <div class="col-md-4">
                    <div class="form-group mt-3 position-relative">
                        <select class="form-control floating-input" id="ddlTallyLedgerName">
                            <option selected disabled value="">select</option>

                        </select>
                        <label class="floating-label" for="ddlTallyLedgerName">Tally Ledger Name</label>
                    </div>
                </div>

                <div class="col-md-4">
                    <div class="form-group mt-3 position-relative">
                        <input type="checkbox"   id="rdoIsMetroCity" />
                        <label  for="rdoIsMetroCity">Is Metro City</label>
                    </div>
                </div>

                <div class="col-md-4">
                    <div class="form-group mt-3 position-relative">
                        <input type="text" class="form-control floating-input" placeholder="Adult Worker No (Statutory)" id="inpAdultWorkerNo"  />
                        <label class="floating-label" for="inpAdultWorkerNo">Adult Worker No (Statutory)</label>
                        <span id="spnAdultWorkerNo" style="color:red; display:none;">Please Enter Adult Worker No</span>
                    </div>
                </div>

                <div class="col-md-4">
                    <div class="form-group mt-3 position-relative">
                        <input type="text" class="form-control floating-input" placeholder="Physical Disability" id="inpPhysicalDisability" />
                        <label class="floating-label" for="inpPhysicalDisability">Physical Disability</label>
                        <span id="spnPhysicalDisability" style="color:red; display:none;">Please Enter Physical Disability</span>
                    </div>
                </div>

                <div class="col-md-4">
                    <div class="form-group mt-3 position-relative">
                        <select class="form-control floating-input" id="ddlMinimumWageSkillType">
                            <option selected disabled value="">Select</option>
                            <!-- Add more options as needed -->
                        </select>
                        <label class="floating-label" for="ddlMinimumWageSkillType">Minimum Wages Skill Type Master</label>
                    </div>
                </div>

                <div class="col-md-4">
                    <div class="form-group mt-3 position-relative">
                        <input type="text" class="form-control floating-input" placeholder="Vehicle No" id="inpVehicleNo" />
                        <label class="floating-label" for="inpVehicleNo">Vehicle No</label>
                        <span id="spnVehicleNo" style="color:red; display:none;">Please Enter Vehicle No</span>
                    </div>
                </div>

                <div class="col-md-4">
                    <div class="form-group mt-3 position-relative">
                        <input type="checkbox" id="rdoInsuranceNo" />
                        <label  for="rdoInsuranceNo">Insurance No</label>
                    </div>
                </div>
            </div>
            <hr /> *@
         @*    <div class="row">
                <div class="col-md-12 mb-2">
                    <h6><b>Uniform Details:</b></h6>
                </div>
            </div> *@

          @*   <div class="row px-5">
                <div class="col-md-6">
                    <div class="form-group mt-3 position-relative">
                        <input type="text" class="form-control floating-input" placeholder="Dress Code" id="inpDressCode" />
                        <label class="floating-label" for="inpDressCode">Dress Code</label>
                        <span id="spnDressCode" style="color:red; display:none;">Please Enter Dress Code</span>
                    </div>
                </div>

                <div class="col-md-6">
                    <div class="form-group mt-3 position-relative">
                        <input type="text" class="form-control floating-input" placeholder="Shirt Size" id="inpShirtSize" />
                        <label class="floating-label" for="inpShirtSize">Shirt Size</label>
                        <span id="spnShirtSize" style="color:red; display:none;">Please Enter Shirt Size</span>
                    </div>
                </div>

                <div class="col-md-6">
                    <div class="form-group mt-3 position-relative">
                        <input type="text" class="form-control floating-input" placeholder="Pant Size" id="inpPantSize" />
                        <label class="floating-label" for="inpPantSize">Pant Size</label>
                        <span id="spnPantSize" style="color:red; display:none;">Please Enter Pant Size</span>
                    </div>
                </div>

                <div class="col-md-6">
                    <div class="form-group mt-3 position-relative">
                        <input type="text" class="form-control floating-input" placeholder="Shoe Size" id="inpShoeSize" />
                        <label class="floating-label" for="inpShoeSize">Shoe Size</label>
                        <span id="spnShoeSize" style="color:red; display:none;">Please Enter Shoe Size</span>
                    </div>
                </div>
            </div> *@

            <div class="row mt-3">
                <div class="col-md-2"></div>
                <div class="col-md-8 text-center">
                    
                    <button type="button" id="btnUpdateEmployeeInfo" class="btn px-5" style="background-color:#2395c6 !important; color:white !important;">
                        Update
                    </button>
                    <button type="button" class="btn px-5" style="background-color:#2395c6 !important; color:white !important;display:none;" disabled id="btnUpdatingEmployeeInfo">
                        <span class="spinner-border spinner-border-sm me-2" role="status" aria-hidden="true"></span>
                        Updating...
                    </button>
                </div>
                <div class="col-md-2"></div>
            </div>
            <hr class="mt-0"/>

           

    </form>
</div>
</div>




<script>
    const userPersion=localStorage.getItem('EmployeeId');
      let EmployeeId=localStorage.getItem('CurrentEmployeeId');

    $(document).ready(async function() {
      await  bindReportingManager();
        bindPersionalInfo();

    });

          async function bindReportingManager() {
                try {
                    const response = await $.ajax({
                        type: "GET",
                        url: "@baseUrl/EmployeeMasterAPI/GetReportingList"
                    });

                    if (response.isSuccess) {
                        $('#ddlManagerProbation').searchableSelect({
                            data: response.data || [],
                            valueKey: 'employeeId',
                            textKey: 'employeeName',
                            placeholder: 'Reporting Manager',
                            searchPlaceholder: 'Search reporting...',
                            onChange: function(item) {
                                // Handle onChange event if needed
                            }
                        });
                    }
                } catch (error) {
                    console.error("AJAX Error:", error);
                }
            }


    async function bindPersionalInfo() {
        $.ajax({
            type: "GET",
            url: "@baseUrl/EmployeeMasterAPI/GetPersonalInfoById/"+EmployeeId,
            success: function (data) {
                if (data.isSuccess) {
                     setPersonalInfo(data.data);

                }
            },
            error: function (xhr, status, error) {
                console.error("AJAX Error: " + status + " - " + error);
            }
        });
    }


    async function getAgeFromDOB(dob) {
		  const birthDate = new Date(dob);
		  const today = new Date();

		  let years = today.getFullYear() - birthDate.getFullYear();
		  let months = today.getMonth() - birthDate.getMonth();
		  const days = today.getDate() - birthDate.getDate();

		  if (days < 0) {
			  months--;
		  }

		  if (months < 0) {
			  years--;
			  months += 12;
		  }

		  return { years, months };
	  }


        async function setPersonalInfo(employee) {
             // Personal Info
          if (employee.DateOfBirth) {
              const age = await getAgeFromDOB(employee.DateOfBirth);
              let ageText = '';

              if (age.years > 0) {
                  ageText += `${age.years} Year${age.years > 1 ? 's' : ''} `;
              }

              if (age.months > 0) {
                  ageText += `${age.months} Month${age.months > 1 ? 's' : ''}`;
              }

              // If both years and months are zero, show nothing or something else:
              if (ageText === '') {
                  ageText = 'Age not available'; // or ''
              }

              $('#empAge').text(ageText.trim());
          }

            $('#ddlGender').val(employee.Gender || 'Male');
            $('#inpPersonalEmailId').val(employee.PersonalEmailId || '');
            $('#inpFatherName').val(employee.FatherName || '');
            $('#inpMotherName').val(employee.MotherName || '');
            $('#ddlBloodGroup').val(employee.BloodGroup || '');
            $('#inpHeight').val(employee.Height || '');
            $('#ddlMaritalStatus').val(employee.MaritalStatus || '');
            $('#inpMarriageDate').val(formatDate(employee.MarriageDate) || '');
            $('#inpMarkIdentification').val(employee.MarkIdentification || '');
            $('#inpReligion').val(employee.Religion || '');
            $('#inpCaste').val(employee.Caste || '');
            $('#ddlCasteCategory').val(employee.CastCategory || '');
            $('#inpAadharCardNo').val(employee.AadharCardNo || '');
            $('#inpPanNo').val(employee.PANNo || ''); // Note: PANNo (if uppercase in API)
            $('#inpDispensary').val(employee.Dispensary || '');
            $('#inpDoctorName').val(employee.DoctorName || '');
            $('#inpDispensaryAddress').val(employee.DispensaryAddress || '');
            $('#inpUanNumber').val(employee.UANNumber || ''); // Note: UANNumber (if uppercase in API)
            $('#inpDrivingLicense').val(employee.DrivingLicense || '');
            $('#inpDrivingLicenseExpiry').val(formatDate(employee.DrivingLicenseExpiry) || '');
            $('#ddlRationCardType').val(employee.RationCardType || '');
            $('#inpRationCardNo').val(employee.RationCardNo || '');
            $('#inpProbationCompletionPeriod').val(employee.ProbationCompletionPeriod || '');

            if (employee.ProbationPeriodType === "Days") {
                $('#probationDay').val(employee.ProbationPeriodType).prop('checked', true);
            } else {
                $('#probationMonth').val(employee.ProbationPeriodType).prop('checked', true);
            }

            $('#ddlManagerProbation').data('searchableSelect').setValue(employee.ManagerProbationId);
            $('#inpConfirmDate').val(formatDate(employee.ConfirmDate) || '');
            $('#inpRetirementDate').val(formatDate(employee.RetirementDate) || '');
            $('#inpOfferDate').val(formatDate(employee.OfferDate) || '');
            $('#inpTraineeCompletionPeriod').val(employee.TraineeCompletionPeriod || '');
            $('input[name="trainingPeriod"]').val(employee.TraineePeriodType || '');
            $('#inpESICNo').val(employee.ESICNo || ''); // Note: ESICNo (if uppercase in API)
            $('#inpPFNo').val(employee.PFNo || ''); // Note: PFNo (if uppercase in API)
            $('#inpNoOfChildren').val(employee.NoOfChildren || '');
        }

        function formatDate(isoDateStr) {
            if (!isoDateStr) return '';
      return isoDateStr.split('T')[0];
    }
     function convertToDecimal(value) {
            let decimalValue = parseFloat(value);
            return isNaN(decimalValue) ? 0 : decimalValue;
        }
    function showBtnEmployeeInfoLoder()
    {
        $('#btnUpdateEmployeeInfo').hide();
         $('#btnUpdatingEmployeeInfo').show();
    }
    function hideBtnEmployeeInfoLoder()
    {
        $('#btnUpdateEmployeeInfo').show();
            $('#btnUpdatingEmployeeInfo').hide();
    }

    $("#btnUpdateEmployeeInfo").click(function(){
        showBtnEmployeeInfoLoder();
        const setNullIfEmpty = (value) => {
                    return value === "" ? null : value;
                };
        var employeeInfoData={
                Id:EmployeeId,
                Gender: setNullIfEmpty($('#ddlGender').val()),
                PersonalEmailId: setNullIfEmpty($('#inpPersonalEmailId').val()),
                FatherName: setNullIfEmpty($('#inpFatherName').val()),
                MotherName: setNullIfEmpty($('#inpMotherName').val()),
                BloodGroup: setNullIfEmpty($('#ddlBloodGroup').val()),
                Height: setNullIfEmpty($('#inpHeight').val()),
                MaritalStatus: setNullIfEmpty($('#ddlMaritalStatus').val()),
                MarriageDate: setNullIfEmpty($('#inpMarriageDate').val()),
                MarkIdentification: setNullIfEmpty($('#inpMarkIdentification').val()),
                Religion: setNullIfEmpty($('#inpReligion').val()),
                Caste: setNullIfEmpty($('#inpCaste').val()),
                CastCategory: setNullIfEmpty($('#ddlCasteCategory').val()),
                AadharCardNo: setNullIfEmpty($('#inpAadharCardNo').val()),
                PANNo: setNullIfEmpty($('#inpPanNo').val()),
                Dispensary: setNullIfEmpty($('#inpDispensary').val()),
                DoctorName: setNullIfEmpty($('#inpDoctorName').val()),
                DispensaryAddress: setNullIfEmpty($('#inpDispensaryAddress').val()),
                UANNumber: setNullIfEmpty($('#inpUanNumber').val()),
                DrivingLicense: setNullIfEmpty($('#inpDrivingLicense').val()),
                DrivingLicenseExpiry: setNullIfEmpty($('#inpDrivingLicenseExpiry').val()),
                RationCardType: setNullIfEmpty($('#ddlRationCardType').val()),
                RationCardNo: setNullIfEmpty($('#inpRationCardNo').val()),

                 ProbationCompletionPeriod:convertToDecimal($('#inpProbationCompletionPeriod').val()),
                ProbationPeriodType: $('input[name="day"]:checked').val(),
                ManagerProbationId: $('#ddlManagerProbation').data('searchableSelect').getValue(),
                ConfirmDate: setNullIfEmpty($('#inpConfirmDate').val()),
                RetirementDate: setNullIfEmpty($('#inpRetirementDate').val()),
                OfferDate: setNullIfEmpty($('#inpOfferDate').val()),
                    TraineeCompletionPeriod: convertToDecimal($('#inpTraineeCompletionPeriod').val()),
                TraineePeriodType: setNullIfEmpty($('input[name="trainingPeriod"]:checked').val()),
                NoOfChildren: setNullIfEmpty($('#inpNoOfChildren').val()),
                ESICNo: setNullIfEmpty($('#inpESICNo').val()),
                PFNo: setNullIfEmpty($('#inpPFNo').val()),

                UpdatedBy:userPersion
        }
             $.ajax({
                    url: '@baseUrl/EmployeeMasterAPI/UpdatePersonalInfo',
                    type: 'POST',
                    contentType: 'application/json',
                    data: JSON.stringify(employeeInfoData),
                    success: function(response) {
                        if (response.isSuccess) {
                         round_success_noti(response.responseMessage);
                         bindPersionalInfo();
                        } 
                        else 
                        {
                            round_error_noti(response.responseMessage);

                        }
                            hideBtnEmployeeInfoLoder();
                    },
                    error: function(xhr, status, error) {
                                hideBtnEmployeeInfoLoder();

                        console.error('Error:', error);

                    }
              });

    })
</script>

