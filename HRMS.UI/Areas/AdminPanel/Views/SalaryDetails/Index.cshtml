@inject IConfiguration Configuration
@{
    ViewData["Title"] = "Salary Details";
    Layout = "~/Areas/AdminPanel/Views/Shared/_AdminLayout.cshtml";
    string baseUrl = Configuration["BaseUrlSettings:baseUrl"];
    var uri = new Uri(baseUrl);
    string baseDomainUrl = $"{uri.Scheme}://{uri.Host}:{uri.Port}";
    string UIBaseUrl = Configuration["UIBaseUrlSettings:baseUrl"];
}

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

    <style>




    .salary-box {
        background-color: white !important;
        border: 1px solid #ccc;
        padding: 12px;
        border-radius: 5px;
    }

    .salary-header {
        background-color: #3e4b6d;
        color: white;
        font-weight: bold;
        padding: 8px 15px;
        border-top-left-radius: 4px;
        border-top-right-radius: 4px;
    }




    .form-group-row {
        margin-bottom: 20px;
        gap: 15px;
    }

    .form-label {
        min-width: 100px;
        font-weight: 500;
        color: #495057;
        font-size: 14px;
        margin-bottom: 0;
    }



    .btn-go  {
        padding: 5px 30px;
        font-size: 14px;
        font-weight: 500;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        transition: all 0.3s;
        margin: 0 5px;
    }

    #btnGo, #btnGoing {
        background-color: #2395c6;
        color: #fff;
    }

    .btn-add {
        padding: 5px 30px;
        font-size: 14px;
        font-weight: 500;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        transition: all 0.3s;
        margin: 0 5px;
        background-color: #2395c6;
        color: #fff;
    }

        .btn-add:hover{
            background-color: #2395c6;
            color: #fff;
        }

    #btnDelete, #btnDeleting {
        padding: 5px 30px;
        font-size: 14px;
        font-weight: 500;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        transition: all 0.3s;
        margin: 0 5px;  
        background-color: #dc3545;
        ;
        color: #fff;
    }

    #btnClear {
        background-color:grey;
        color: #fff;
    }

        #btnFetchSalary:hover {
            background-color: #1d7ba3;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(35, 149, 198, 0.3);
        }

    .btn-go:last-child {
        background-color: #6c757d;
        color: #fff;
    }

        .btn-go:last-child:hover {
            background-color: #5a6268;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(108, 117, 125, 0.3);
        }

    .text-danger {
        color: #dc3545;
    }

    .error-message {
        font-size: 12px;
        margin-top: 5px;
        display:none;
    }




    #salaryGridContainer {
        max-height: 700px;
       
    }

    </style>


<div class="salary-box">
    <div class="salary-header">
            <div class="d-flex justify-content-between align-items-center">
            <div class="search-heading">Search Monthly Salary</div>
                <a href="/AdminPanel/SalaryDetails/MonthlySalary" class="btn-add ">Add</a>
            </div>
    </div>

    <div class="row justify-content-center mt-3">
        <div class="col-lg-10">
            <div class="row">
                <!-- Left Column -->
                <div class="col-md-6">
                    <!-- Month Dropdown (Single Select) -->
                    <div class="form-group-row d-flex align-items-center">
                        <label class="form-label">Month<span class="text-danger">*</span> :</label>
                        <div class="form-floating-custom flex-grow-1">
                            <div class="searchable-select-wrapper" id="monthWrapper">
                                <label for="monthDropdown">Select Month <span class="text-danger">*</span></label>
                                <input type="text" class="searchable-select-input" id="monthDropdown" readonly>
                                <span class="searchable-select-arrow">
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16">
                                        <path d="M7.247 11.14 2.451 5.658C1.885 5.013 2.345 4 3.204 4h9.592a1 1 0 0 1 .753 1.659l-4.796 5.48a1 1 0 0 1-1.506 0z" />
                                    </svg>
                                </span>
                                <div class="searchable-select-dropdown">
                                    <div class="searchable-select-search">
                                        <input type="text" placeholder="Search month..." class="search-input">
                                    </div>
                                    <div class="multi-select-actions">
                                        <button type="button" class="multi-select-btn select-all-btn">Select All</button>
                                        <button type="button" class="multi-select-btn clear-all-btn">Clear All</button>
                                    </div>
                                    <div class="searchable-select-options"></div>
                                </div>
                            </div>
                            <span class="text-danger error-message" id="errorMonth" >Please select month</span>
                        </div>
                    </div>

                    <!-- Branch Dropdown (Single Select) -->
                    <div class="form-group-row d-flex align-items-center">
                        <label class="form-label">Branch :</label>
                        <div class="form-floating-custom flex-grow-1">
                            <div class="searchable-select-wrapper" id="branchWrapper">
                                <label for="branchDropdown">Select Branch</label>
                                <input type="text" class="searchable-select-input" id="branchDropdown" readonly>
                                <span class="searchable-select-arrow">
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16">
                                        <path d="M7.247 11.14 2.451 5.658C1.885 5.013 2.345 4 3.204 4h9.592a1 1 0 0 1 .753 1.659l-4.796 5.48a1 1 0 0 1-1.506 0z" />
                                    </svg>
                                </span>
                                <div class="searchable-select-dropdown">
                                    <div class="searchable-select-search">
                                        <input type="text" placeholder="Search branch..." class="search-input">
                                    </div>
                                    <div class="multi-select-actions">
                                        <button type="button" class="multi-select-btn select-all-btn">Select All</button>
                                        <button type="button" class="multi-select-btn clear-all-btn">Clear All</button>
                                    </div>
                                    <div class="searchable-select-options"></div>
                                </div>
                            </div>
                            <span class="text-danger error-message" id="errorBranch"></span>
                        </div>
                    </div>
                </div>

                <!-- Right Column -->
                <div class="col-md-6">
                    <!-- Year Dropdown (Single Select) -->
                    <div class="form-group-row d-flex align-items-center">
                        <label class="form-label">Year<span class="text-danger">*</span> :</label>
                        <div class="form-floating-custom flex-grow-1">
                            <div class="searchable-select-wrapper" id="yearWrapper">
                                <label for="yearDropdown">Select Year <span class="text-danger">*</span></label>
                                <input type="text" class="searchable-select-input" id="yearDropdown" readonly>
                                <span class="searchable-select-arrow">
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16">
                                        <path d="M7.247 11.14 2.451 5.658C1.885 5.013 2.345 4 3.204 4h9.592a1 1 0 0 1 .753 1.659l-4.796 5.48a1 1 0 0 1-1.506 0z" />
                                    </svg>
                                </span>
                                <div class="searchable-select-dropdown">
                                    <div class="searchable-select-search">
                                        <input type="text" placeholder="Search year..." class="search-input">
                                    </div>
                                    <div class="multi-select-actions">
                                        <button type="button" class="multi-select-btn select-all-btn">Select All</button>
                                        <button type="button" class="multi-select-btn clear-all-btn">Clear All</button>
                                    </div>
                                    <div class="searchable-select-options"></div>
                                </div>
                            </div>
                            <span class="text-danger error-message " id="errorYear">Please select year</span>
                        </div>
                    </div>

                    <!-- Employee Dropdown (Multi Select) -->
                    <div class="form-group-row d-flex align-items-center">
                        <label class="form-label">Employee Code:</label>
                        <div class="form-floating-custom flex-grow-1">
                                <div class="d-flex align-items-center">
                                    <input type="text" class="form-control form-control-sm form-control-fixed" id="empCode" placeholder="Enter code">
                             </div>
                       </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Bottom Buttons -->
    <div class="col-md-12 text-center mt-4">
       
        <button class="btn-go" id="btnGo">Go</button>
        <button class="btn-go" id="btnGoing" disabled style="display:none;"><span class="spinner-border spinner-border-sm me-2" role="status"></span> Go</button>
        <button class="btn-go" id="btnClear">Clear</button>
        <button onclick="goBack()" class="btn-go">Back</button>
        
    </div>

    
    <div id="recordDetails" style="display:none;">
        <hr class="my-3">
        <div class="salary-header " >
            <div class="d-flex justify-content-between align-items-center">
                <div class="search-heading">Salary Records</div>
            </div>
        </div>

        <div class="d-flex justify-content-end mt-2" id="actionButtons" >
            <button id="btnDelete" class="btn-custom me-2">Delete</button>
            <button id="btnDeleting" disabled style="display:none;" class="btn-custom me-2"><span class="spinner-border spinner-border-sm me-2" role="status"></span> Deleting</button>
        </div>

        <div id="salaryGridContainer" class="bg-white p-3 rounded"></div>
    </div>

</div>

  

    <!-- Salary Slip Modal -->
    <div class="modal fade" id="salarySlipModal" tabindex="-1" aria-labelledby="salarySlipLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header bg-secondary text-white">
                    <h5 class="modal-title" id="salarySlipLabel">Salary Slip - <span id="modalMonthYear"></span></h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body" id="salarySlipContent"></div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-light" data-bs-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>

<script>


    const savedCompany = localStorage.getItem('selectedCompany');
    var companyDetails = JSON.parse(savedCompany);
    const CompanyId=companyDetails.CompanyId;
    const EmployeeId=localStorage.getItem('EmployeeId');
    const Token=localStorage.getItem("authToken");

     $(document).ready( async function () {
        //    const savedMonth = localStorage.getItem("SalaryMonth") ;
        //     const savedYear = localStorage.getItem("SalaryYear") ;
        //     const savedEmpCodes = localStorage.getItem("SalaryEmpCodes") || "";
        //     const savedBranchId = localStorage.getItem("SalaryBranchId") || 0;
        //     BindBranchDropdown();
        // await populateYearDropdown();
       
        // if (savedMonth && savedYear) {
        //     $('#month').val(savedMonth);
        //     $('#year').val(savedYear);
        //     $('#empCode').val(savedEmpCodes);
        //     $('#branch').val(savedBranchId);
        
        //     // Delay to ensure UI is ready
        //     setTimeout(() => { 
        //         fetchAndBindSalaryData(savedMonth, savedYear, savedEmpCodes, savedBranchId);
        //     }, 300);
        // }

        // Optional: Clear localStorage after use
        localStorage.removeItem("SalaryMonth");
        localStorage.removeItem("SalaryYear");
        localStorage.removeItem("SalaryEmpCodes");
        localStorage.removeItem("SalaryBranchId");

        
          

      const months = [
            { monthNumber: 1,monthName: 'January' },
            { monthNumber: 2,monthName: 'February' },
            {monthNumber: 3, monthName: 'March' },
            { monthNumber: 4,monthName: 'April' },
            { monthNumber: 5,monthName: 'May' },
            {monthNumber: 6, monthName: 'June' },
            {monthNumber: 7, monthName: 'July' },
            {monthNumber: 8, monthName: 'August' },
            {monthNumber: 9, monthName: 'September' },
            { monthNumber: 10,monthName: 'October' },
            {monthNumber: 11,monthName: 'November' },
            {monthNumber: 12, monthName: 'December' }
        ];

        // Generate years (current year - 5 to current year + 2)
        const currentYear = new Date().getFullYear();
        const years = [];
        for (let i = currentYear-1 ; i <= currentYear ; i++) {
            years.push({ yearName: i.toString() });
        }
            // Initialize Month Dropdown (Single Select)
        $('#monthDropdown').searchableSelect({
            data: months,
            valueKey: 'monthNumber',
            textKey: 'monthName',
            searchPlaceholder: 'Search month...',
            onChange: function(item) {
                
            }
        });

        // Initialize Year Dropdown (Single Select)
        $('#yearDropdown').searchableSelect({
            data: years,
            valueKey: 'yearName',
            textKey: 'yearName',
            searchPlaceholder: 'Search year...',
            onChange: function(item) {
                
            }
        });

         

            BindBranchDropdown();

    });


    function showbtnLoader(){
        $("#btnGoing").show();
        $("#btnGo").hide();
    }
    function hidebtnLoader(){
        $("#btnGoing").hide();
        $("#btnGo").show();
    }
    function showbtnDeleteLoader(){
        $("#btnDeleting").show();
        $("#btnDelete").hide();
    }
    function hidebtnDeleteLoader(){
        $("#btnDeleting").hide();
        $("#btnDelete").show();
    }

       function BindBranchDropdown() {
              
        $.ajax({
             url: '@baseUrl/BranchAPI/GetAllBranchesListByCompanyId/'+CompanyId,
                    method: 'GET',
                        headers: {
                                'Authorization': 'Bearer ' + Token
                            },
            success: function (response) {
                if (response?.data?.length > 0) {
                    
                    $('#branchDropdown').searchableSelect({
                        data: response.data||[],
                        valueKey: 'branchId',
                        textKey: 'branchName',
                        searchPlaceholder: 'Search ...',
                        placeholder: 'Branch ...',
                        onChange: function(items) {
                           
                        }
                    });
                    }

            },
            error: function () {
                console.log("Failed to load branches.");
            }
        });
    }

     function goBack() {
      window.location.href = '@UIBaseUrl/AdminPanel/Home/index';
    }

     
    $('#btnGo').on('click', function () {
       showbtnLoader();
        $('#recordDetails').hide();
       const month = $('#monthDropdown').data('searchableSelect').getValue();
    const year = $('#yearDropdown').data('searchableSelect').getValue();
    const empCode = $('#empCode').val();
      branch = $('#branchDropdown').data('searchableSelect').getValue();
         if(!branch){
             branch=0;
         }
    let isValid = true;

    if (!month) {
        $('#errorMonth').show();
        isValid = false;
    } else {
        $('#errorMonth').hide();
    }

    if (!year) {
        $('#errorYear').show();
        isValid = false;
    } else {
        $('#errorYear').hide();
    }


    if (!isValid) {
          hidebtnLoader();
        return;
    }

     fetchAndBindSalaryData(month, year, empCode, branch);

    });


    function fetchAndBindSalaryData(month, year, empCode, branch) {
        if (!month || !year) {
             round_error_noti("Please select both Month and Year.");
             hidebtnLoader();
            return;
        }
 
        const requestData = {
            Month: parseInt(month),
            Year: parseInt(year),
            EmployeeCodes:  empCode === "" ?'': empCode ,
            BranchId: branch === "" ? 0:parseInt(branch) 
        };

        $.ajax({
            url: '@(baseDomainUrl + "/api/MonthlySalaryDetailsAPI/GetAll")',
            type: "POST",
            data: JSON.stringify(requestData),
            contentType: "application/json",
            success: function (response) {
                if (response.isSuccess) { 
                    
             $("#salaryGridContainer").dxDataGrid({
                dataSource: response.data,
                keyExpr: "employeeCode",
                showBorders: true,
                columnAutoWidth: true,
                height:300,
                selection: {
                    mode: "multiple",
                    showCheckBoxesMode: "always"
                },
                paging: {
                    enabled: false // Disable paging to allow scrolling
                },
                scrolling: {
                    mode: "virtual" // Enables smooth scrolling
                },
                columns: [
                    { dataField: "id", caption: "ID", visible: false },
                    { dataField: "employeeCode", caption: "Employee Code" },
                    { dataField: "employeeName", caption: "Name" },
                    { dataField: "branchName", caption: "Branch" },
                    { dataField: "grossSalary", caption: "Gross Salary" },
                    { dataField: "netSalary", caption: "Net Salary" },
                    { dataField: "presentDays", caption: "Present Days" },
                    { dataField: "absentDays", caption: "Absent Days" },
                    { dataField: "salaryDays", caption: "Salary Days" },
                    { dataField: "totalDeductions", caption: "Deductions" },
                    { dataField: "arrears", caption: "Arrears" },
                    { dataField: "otherDeduction", caption: "OtherDeduction" },
                    { dataField: "createdDate", caption: "Created", dataType: "date" },
                    {
                        caption: "View",
                        cellTemplate: function (container, options) {
                            $("<i>")
                                .addClass("fas fa-magnifying-glass")
                                .css({
                                    cursor: "pointer",
                                    color: "#007bff",
                                    fontSize: "18px",
                                    padding: "5px"
                                })
                                .attr("title", "View Salary Slip")
                                .on('click', function () {
                                    showSalarySlipModal(options.data);
                                })
                                .appendTo(container);
                        }
                    }
                ],
            });

                   $('#recordDetails').show();
      
                } else {
                    
                       $('#recordDetails').hide();
                       round_error_noti(response.responseMessage);
                }
                 hidebtnLoader();
            },
            error: function () {
                 hidebtnLoader();
                $('#recordDetails').hide();
                round_error_noti("An error occurred while fetching salary records");
            }
        });
    }


      $('#btnDelete').on('click', function () {
        deleteSalaryDetails();
    });

     function deleteSalaryDetails() {
         showbtnDeleteLoader();
        // Get selected rows from the DevExtreme grid
        const grid = $("#salaryGridContainer").dxDataGrid("instance");
        const selectedRows = grid.getSelectedRowsData();

        if (selectedRows.length === 0) {
            hidebtnDeleteLoader();
             round_error_noti("Please select at least one row to delete.");
            return;
        }

        // Ask for browser confirmation
        const isConfirmed = confirm("Are you sure you want to delete the selected salary record(s)?");

        if (!isConfirmed) return;

        // Collect IDs of selected rows
        const deleteIds = selectedRows.map(row => row.id);

        // Prepare delete object
        const deleteObj = {
            id: deleteIds,
            deletedBy: EmployeeId
        };

        // Call DELETE API
        $.ajax({
            url: '@baseUrl/MonthlySalaryDetailsAPI/DeleteSalaryDetails',
            type: 'DELETE',
            contentType: 'application/json',
            data: JSON.stringify(deleteObj),
            success: function (response) {
                if (response.isSuccess) {
                    round_success_noti(response.responseMessage || "Deleted successfully.");         
                    const month = $('#monthDropdown').data('searchableSelect').getValue();
                const year = $('#yearDropdown').data('searchableSelect').getValue();
                const empCode = $('#empCode').val();
                  branch = $('#branchDropdown').data('searchableSelect').getValue();
                     if(!branch){
                         branch=0;
                     }
                     fetchAndBindSalaryData(month, year, empCode, branch);

                } else {

                   round_error_noti(response.responseMessage);
                }
                hidebtnDeleteLoader();
            },
            error: function () {
                hidebtnDeleteLoader();
                   round_error_noti("Something went wrong!");
            }
        });
    }

    function showSalarySlipModal(data) {
        $('#modalMonthYear').text(`${data.monthName} ${data.year}`);
        console.log('data', data);

        // Separate positive and negative allowances
        const positiveEarnings = [
            { name: "Basic Salary", actual: data.basicSalary },
            { name: "HRA", actual: data.hra },
            { name: "Conveyance", actual: data.conveyanceAllowance },
            { name: "Child Education", actual: data.childEducationAllowance },
            { name: "Medical", actual: data.medicalAllowance },
            { name: "Arrears", actual: data.arrears }
        ].filter(e => e.actual > 0);

        // Handle negative deputation allowance
        const deputationAllowance = data.deputationAllowance || 0;
        if (deputationAllowance > 0) {
            positiveEarnings.push({ name: "Deputation Allowance", actual: deputationAllowance });
        }

        // Calculate total from VISIBLE items only
        const totalEarnings = positiveEarnings.reduce((sum, e) => sum + e.actual, 0);

        const deductions = [
            { name: "PF", actual: data.pf },
            { name: "ESIC", actual: data.esic },
            { name: "Professional Tax", actual: data.professionalTax },
            { name: "Group Medical", actual: data.groupMedical },
            { name: "Term Insurance", actual: data.termInsurance },
            { name: "LWF", actual: data.lwf },
            { name: "TDS", actual: data.tds },
            { name: "Loan", actual: data.loan },
            { name: "OtherDeduction", actual: data.otherDeduction }
        ].filter(d => d.actual > 0);

        // Add negative deputation allowance as deduction
        if (deputationAllowance < 0) {
            deductions.push({
                name: "Deputation Allowance (Recovery)",
                actual: Math.abs(deputationAllowance)
            });
        }

        // Calculate total from VISIBLE items only
        const totalded = deductions.reduce((sum, d) => sum + d.actual, 0);

        // Compact header info
        const headerInfo = `
            <div class="row mb-1" style="font-size: 12px;">
                <div class="col-md-6 p-1"><strong>Employee:</strong> ${data.employeeCode} - ${data.employeeName}</div>
                <div class="col-md-6 p-1"><strong>Present:</strong> ${data.presentDays} | <strong>Week off:</strong> ${data.weekOff}</div>
            </div>
            <div class="row mb-1" style="font-size: 12px;">
                <div class="col-md-6 p-1"><strong>Month Days:</strong> ${data.monthDays} | <strong>Holiday:</strong> ${data.holiday}</div>
                <div class="col-md-6 p-1"><strong>Absent:</strong> ${data.absentDays} | <strong>Salary Days:</strong> ${data.salaryDays}</div>
                <div class="col-md-6 p-1"><strong>Paid Leave Days:</strong> ${data.leave}
            </div>
        `;

        // CSS for compact design
        const compactCSS = `
            <style>
                .compact-modal {
                    max-width: 650px !important;
                    margin: 0.5rem auto;
                }
                .compact-table {
                    margin-bottom: 5px !important;
                    font-size: 12px !important;
                }
                .compact-table thead th {
                    background-color: #f5f5f5 !important;
                    padding: 4px 6px !important;
                }
                .compact-table tbody td {
                    padding: 3px 6px !important;
                }
                .compact-table .table-light {
                    background-color: #f5f5f5 !important;
                }
                .compact-row {
                    margin: 0 -3px !important;
                }
                .compact-col {
                    padding: 0 3px !important;
                }
            </style>
        `;

        // Earnings table
        const earningsTable = `
            <div class="col-md-6 compact-col">
                <table class="table table-bordered compact-table">
                    <thead>
                        <tr>
                            <th colspan="2" class="text-center">Earnings</th>
                        </tr>
                        <tr class="table-light">
                            <th style="width: 70%">Component</th>
                            <th class="text-end">Amount</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${positiveEarnings.map(e => `
                            <tr>
                                <td>${e.name}</td>
                                <td class="text-end">₹${e.actual.toFixed(2)}</td>
                            </tr>
                        `).join('')}
                        <tr class="fw-bold">
                            <td>Total Earnings</td>
                            <td class="text-end">₹${totalEarnings.toFixed(2)}</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        `;

        // Deductions table
        const deductionsTable = `
            <div class="col-md-6 compact-col">
                <table class="table table-bordered compact-table">
                    <thead>
                        <tr>
                            <th colspan="2" class="text-center">Deductions</th>
                        </tr>
                        <tr class="table-light">
                            <th style="width: 70%">Component</th>
                            <th class="text-end">Amount</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${deductions.map(d => `
                            <tr>
                                <td>${d.name}</td>
                                <td class="text-end">₹${d.actual.toFixed(2)}</td>
                            </tr>
                        `).join('')}
                        <tr class="fw-bold">
                            <td>Total Deductions</td>
                            <td class="text-end">₹${totalded.toFixed(2)}</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        `;

        const content = `
            ${compactCSS}
            ${headerInfo}
            <div class="row compact-row">
                ${earningsTable}
                ${deductionsTable}
            </div>
            <div class="row mt-1">
                <div class="col-md-12 text-end">
                    <h6 class="text-success mb-0" style="font-size: 13px;">Net Salary: ₹${data.netSalary.toFixed(2)}</h6>
                </div>
            </div>
        `;

        // Apply compact modal size
        $('#salarySlipModal .modal-dialog').removeClass('modal-xl').addClass('modal-lg');
        $('#salarySlipContent').html(content);

        const modal = new bootstrap.Modal(document.getElementById('salarySlipModal'));
        modal.show();
    }  

    $('#btnClear').on('click', function () {
           
        $('#yearDropdown').data('searchableSelect').clear();
        $('#branchDropdown').data('searchableSelect').clear();
        $('#monthDropdown').data('searchableSelect').clear();
        $('#empCode').val('');
        
        
    // Clear the DataGrid
    const gridInstance = $("#salaryGridContainer").dxDataGrid("instance");
    if (gridInstance) {
        gridInstance.dispose();
        $("#salaryGridContainer").empty();
    }

      hidebtnLoader();
      hidebtnDeleteLoader();
     $('#recordDetails').hide();
    });




</script>
